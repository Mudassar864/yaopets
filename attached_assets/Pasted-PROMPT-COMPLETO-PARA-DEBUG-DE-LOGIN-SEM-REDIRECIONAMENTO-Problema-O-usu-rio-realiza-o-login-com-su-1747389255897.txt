PROMPT COMPLETO PARA DEBUG DE LOGIN SEM REDIRECIONAMENTO
Problema:

O usuÃ¡rio realiza o login com sucesso, a mensagem "Login realizado com sucesso" aparece, mas nÃ£o Ã© redirecionado para a home (/home). Fica travado ou volta para login.

âœ… CHECKLIST GERAL DE DIAGNÃ“STICO (COM 100% E 1% DE PROBABILIDADE)
ğŸ” 1. O estado de autenticaÃ§Ã£o estÃ¡ sincronizado?
 O session (ex: do next-auth) estÃ¡ realmente sendo atualizado?

 O estado global de authContext estÃ¡ disponÃ­vel na pÃ¡gina seguinte?

 Algum setState estÃ¡ ocorrendo depois do router.push, o que cancela o efeito?

 HÃ¡ await faltando em algum signIn() ou setSession()?

ğŸ“¦ 2. O botÃ£o de login chama o router.push no momento certo?
 EstÃ¡ usando signIn(..., { redirect: false }) + router.push() manual?

 O router.push estÃ¡ realmente sendo executado? (adicionar console.log("vai redirecionar") antes)

 HÃ¡ setTimeout() ou setTimeout(0) que estÃ¡ atrasando ou bugando o push?

 O botÃ£o estÃ¡ com loading infinito e impedindo aÃ§Ãµes subsequentes?

ğŸŒ 3. A rota /home realmente existe e estÃ¡ acessÃ­vel?
 O caminho /home estÃ¡ disponÃ­vel dentro de /pages/home.tsx ou /app/home/page.tsx?

 A pÃ¡gina /home dÃ¡ erro 404 ao acessar diretamente?

 EstÃ¡ usando basePath customizado no next.config.js?

 EstÃ¡ em ambiente de build (next build) com arquivos ausentes?

ğŸ” 4. Redirecionamento cÃ­clico acontecendo logo apÃ³s login
 Existe algum useEffect(() => { if (!session) router.push('/login') })?

 Esse useEffect Ã© executado antes de session estar de fato pronto?

 HÃ¡ session === undefined sendo tratado como not authenticated?

ğŸ§± 5. Middleware (middleware.ts) bloqueando rota apÃ³s login
 HÃ¡ verificaÃ§Ã£o de !token ou !session que redireciona para /login?

 Middleware estÃ¡ sendo aplicado em matcher genÃ©rico tipo ["/((?!api|_next).*)"]?

 EstÃ¡ usando next-auth e getToken() com atraso na atualizaÃ§Ã£o?

ğŸ” 6. next-auth ou sistema similar mal configurado
 EstÃ¡ usando o signIn() com redirect: false mas esqueceu o router.push?

 Configurou pages: { signIn: '/login' } mas nÃ£o pages: { signIn: '/login', callbackUrl: '/home' }?

 Callback URL foi ignorada ou sobrescrita?

 SessÃ£o do usuÃ¡rio nÃ£o estÃ¡ persistindo no cookie (secure: true em ambiente local http)?

 jwt() ou session() no next-auth nÃ£o estÃ£o retornando os dados corretamente?

âš™ï¸ 7. O router.push() pode estar falhando silenciosamente
 EstÃ¡ usando o router.push() antes do estado de login concluir?

 EstÃ¡ chamando router.push('/home') dentro de um useEffect mal ordenado?

 HÃ¡ erro silencioso dentro de try { ... } catch {} sem console.error()?

 router.push() foi chamado mas pÃ¡gina nÃ£o mudou (verifique console de rede)?

ğŸ“¡ 8. Backend nÃ£o estÃ¡ salvando corretamente o usuÃ¡rio/autenticaÃ§Ã£o
 O usuÃ¡rio existe no banco apÃ³s registro?

 HÃ¡ delay entre registro â†’ autenticaÃ§Ã£o que causa inconsistÃªncia?

 Backend responde com status 200 mas com success: false no corpo?

 fetch("/api/auth") retorna sessÃ£o vÃ¡lida apÃ³s login?

ğŸ­ 9. HÃ¡ renderizaÃ§Ã£o condicional com checagem incorreta
 A pÃ¡gina /home depende de user, mas user vem como null inicialmente e redireciona?

 HÃ¡ SSR com getServerSideProps que bloqueia se session nÃ£o estiver pronta?

 PÃ¡gina /home estÃ¡ protegida por withAuth() ou requireAuth() sem fallback?

ğŸ“ 10. Estrutura de pastas estÃ¡ separando layout/app de forma inesperada
 EstÃ¡ usando /app e /pages ao mesmo tempo?

 Login estÃ¡ em um layout e home estÃ¡ em outro? Layouts diferentes podem resetar contexto.

 layout.tsx de /app nÃ£o mantÃ©m estado ao navegar entre as rotas?

ğŸ’¾ 11. O banco de dados foi criado corretamente?
 A collection de usuÃ¡rios (users) estÃ¡ criada?

 HÃ¡ schema mal definido (ex: unique: true em email, mas tentativa de duplicaÃ§Ã£o)?

 ConexÃ£o com o banco nÃ£o estÃ¡ retornando erro 500 mas tambÃ©m nÃ£o estÃ¡ salvando?

 createUser() salva, mas nÃ£o retorna o ID ou token?

ğŸª„ 12. TransiÃ§Ã£o entre pÃ¡ginas nÃ£o estÃ¡ definida ou foi quebrada
 HÃ¡ animaÃ§Ãµes de rota (ex: framer motion, AnimatePresence) que estÃ£o com timeout travado?

 HÃ¡ Suspense com fallback travado ou mal implementado?

 router.events.on("routeChangeComplete") nunca Ã© disparado?

ğŸ§¼ 13. CÃ³digo estÃ¡ funcionando, mas o cache estÃ¡ atrapalhando
 Cache local ou do navegador interferindo (session antiga)?

 Algum localStorage ou sessionStorage mantÃ©m user=null e trava?

 Componente AuthProvider depende de localStorage e nÃ£o detecta mudanÃ§a?

ğŸ” 14. O toast de sucesso nÃ£o significa sucesso real
 O toast.success("Login feito!") aparece antes de o login ser validado?

 Foi colocado antes do await signIn()?

 EstÃ¡ usando res.ok sem verificar res.error?

ğŸ“¡ 15. ComunicaÃ§Ã£o com API ou back-end com problemas
 A resposta da API de login estÃ¡ vazia ou incompleta?

 Resposta de login estÃ¡ com status 200 mas sem atualizar cookies?

 EstÃ¡ usando fetch em lugar errado? Ex: login do lado cliente chama rota protegida?

ğŸŒ 16. Ambiente de produÃ§Ã£o vs. local com comportamento diferente
 Em produÃ§Ã£o, a URL base estÃ¡ diferente? (BASE_URL, NEXTAUTH_URL)?

 Em produÃ§Ã£o, cookies SameSite ou secure impedem persistÃªncia?

ğŸ”§ 17. Build quebrado ou client side rendering falho
 Em SSR/SSG a rota /home nÃ£o estÃ¡ sendo gerada?

 Tem erro no console client-side mas nÃ£o afeta a API?

âœ… INSTRUÃ‡ÃƒO FINAL
Por favor, revise todos os pontos acima e forneÃ§a:

Logs do console apÃ³s o login

Resposta completa da API de login

CÃ³digo da funÃ§Ã£o de login (frontend e backend, se houver)

CÃ³digo da pÃ¡gina /home (ou redirecionamento)

Middleware (se existir)

ConfiguraÃ§Ã£o de next-auth ou autenticaÃ§Ã£o customizada

Se quiser, posso montar um esqueleto mÃ­nimo funcional de um sistema de login + redirecionamento com next-auth, router.push, useSession e middleware funcionando corretamente para comparaÃ§Ã£o.

SÃ³ pedir.